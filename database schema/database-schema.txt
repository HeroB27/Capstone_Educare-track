-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.admins (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  username text NOT NULL UNIQUE,
  password text NOT NULL,
  full_name text,
  contact_number text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT admins_pkey PRIMARY KEY (id)
);
CREATE TABLE public.announcements (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  title text,
  content text,
  posted_by_admin_id bigint,
  target_teachers boolean DEFAULT false,
  target_parents boolean DEFAULT false,
  target_guards boolean DEFAULT false,
  target_clinic boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  posted_by_teacher_id bigint,
  CONSTRAINT announcements_pkey PRIMARY KEY (id),
  CONSTRAINT announcements_posted_by_admin_id_fkey FOREIGN KEY (posted_by_admin_id) REFERENCES public.admins(id),
  CONSTRAINT announcements_posted_by_teacher_id_fkey FOREIGN KEY (posted_by_teacher_id) REFERENCES public.teachers(id)
);
CREATE TABLE public.attendance_logs (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  student_id bigint,
  log_date date DEFAULT CURRENT_DATE,
  time_in timestamp without time zone,
  time_out timestamp without time zone,
  status text,
  remarks text,
  CONSTRAINT attendance_logs_pkey PRIMARY KEY (id),
  CONSTRAINT attendance_logs_student_id_fkey FOREIGN KEY (student_id) REFERENCES public.students(id)
);
CREATE TABLE public.classes (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  grade_level text,
  section_name text,
  strand text,
  adviser_id bigint,
  room_number text,
  school_year text DEFAULT '2025-2026'::text,
  CONSTRAINT classes_pkey PRIMARY KEY (id),
  CONSTRAINT classes_adviser_id_fkey FOREIGN KEY (adviser_id) REFERENCES public.teachers(id)
);
CREATE TABLE public.clinic_staff (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  clinic_id_text text UNIQUE,
  username text NOT NULL UNIQUE,
  password text NOT NULL,
  full_name text,
  role_title text,
  CONSTRAINT clinic_staff_pkey PRIMARY KEY (id)
);
CREATE TABLE public.clinic_visits (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  student_id bigint,
  referred_by_teacher_id bigint,
  reason text,
  nurse_notes text,
  action_taken text,
  time_in timestamp without time zone DEFAULT now(),
  time_out timestamp without time zone,
  parent_notified boolean DEFAULT false,
  status text DEFAULT 'Pending'::text,
  CONSTRAINT clinic_visits_pkey PRIMARY KEY (id),
  CONSTRAINT clinic_visits_student_id_fkey FOREIGN KEY (student_id) REFERENCES public.students(id),
  CONSTRAINT clinic_visits_referred_by_teacher_id_fkey FOREIGN KEY (referred_by_teacher_id) REFERENCES public.teachers(id)
);
CREATE TABLE public.excuse_letters (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  student_id bigint,
  parent_id bigint,
  reason text,
  date_absent date,
  image_proof_url text,
  status text DEFAULT 'Pending'::text,
  teacher_remarks text,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT excuse_letters_pkey PRIMARY KEY (id),
  CONSTRAINT excuse_letters_student_id_fkey FOREIGN KEY (student_id) REFERENCES public.students(id),
  CONSTRAINT excuse_letters_parent_id_fkey FOREIGN KEY (parent_id) REFERENCES public.parents(id)
);
CREATE TABLE public.guards (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  guard_id_text text UNIQUE,
  username text NOT NULL UNIQUE,
  password text NOT NULL,
  full_name text,
  assigned_gate text,
  shift_schedule text,
  CONSTRAINT guards_pkey PRIMARY KEY (id)
);
CREATE TABLE public.holidays (
  holiday_date date NOT NULL UNIQUE,
  description text,
  is_suspended boolean DEFAULT true,
  target_grades text DEFAULT 'All'::text
);
CREATE TABLE public.id_templates (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  template_type text NOT NULL UNIQUE,
  settings jsonb NOT NULL,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT id_templates_pkey PRIMARY KEY (id)
);
CREATE TABLE public.notifications (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  recipient_id bigint,
  recipient_role text,
  title text,
  message text,
  type text,
  is_read boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT notifications_pkey PRIMARY KEY (id)
);
CREATE TABLE public.parents (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  parent_id_text text UNIQUE,
  username text NOT NULL UNIQUE,
  password text NOT NULL,
  full_name text,
  address text,
  contact_number text,
  relationship_type text,
  is_active boolean DEFAULT true,
  CONSTRAINT parents_pkey PRIMARY KEY (id)
);
CREATE TABLE public.settings (
  setting_key text NOT NULL UNIQUE,
  setting_value text
);
CREATE TABLE public.students (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  lrn text NOT NULL UNIQUE,
  student_id_text text UNIQUE,
  full_name text,
  parent_id bigint,
  class_id bigint,
  gender text,
  address text,
  emergency_contact text,
  qr_code_data text,
  profile_photo_url text,
  status text DEFAULT 'Enrolled'::text,
  CONSTRAINT students_pkey PRIMARY KEY (id),
  CONSTRAINT students_parent_id_fkey FOREIGN KEY (parent_id) REFERENCES public.parents(id),
  CONSTRAINT students_class_id_fkey FOREIGN KEY (class_id) REFERENCES public.classes(id)
);
CREATE TABLE public.subject_loads (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  subject_name text,
  teacher_id bigint,
  class_id bigint,
  schedule_time_start time without time zone,
  schedule_time_end time without time zone,
  schedule_days text,
  CONSTRAINT subject_loads_pkey PRIMARY KEY (id),
  CONSTRAINT subject_loads_teacher_id_fkey FOREIGN KEY (teacher_id) REFERENCES public.teachers(id),
  CONSTRAINT subject_loads_class_id_fkey FOREIGN KEY (class_id) REFERENCES public.classes(id)
);
CREATE TABLE public.teachers (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  teacher_id_text text UNIQUE,
  username text NOT NULL UNIQUE,
  password text NOT NULL,
  full_name text,
  department text,
  contact_number text,
  email text,
  is_active boolean DEFAULT true,
  is_gatekeeper boolean DEFAULT false,
  CONSTRAINT teachers_pkey PRIMARY KEY (id)
);


-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE storage.buckets (
  id text NOT NULL,
  name text NOT NULL,
  owner uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  public boolean DEFAULT false,
  avif_autodetection boolean DEFAULT false,
  file_size_limit bigint,
  allowed_mime_types ARRAY,
  owner_id text,
  type USER-DEFINED NOT NULL DEFAULT 'STANDARD'::storage.buckettype,
  CONSTRAINT buckets_pkey PRIMARY KEY (id)
);
CREATE TABLE storage.buckets_analytics (
  name text NOT NULL,
  type USER-DEFINED NOT NULL DEFAULT 'ANALYTICS'::storage.buckettype,
  format text NOT NULL DEFAULT 'ICEBERG'::text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  deleted_at timestamp with time zone,
  CONSTRAINT buckets_analytics_pkey PRIMARY KEY (id)
);
CREATE TABLE storage.buckets_vectors (
  id text NOT NULL,
  type USER-DEFINED NOT NULL DEFAULT 'VECTOR'::storage.buckettype,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT buckets_vectors_pkey PRIMARY KEY (id)
);
CREATE TABLE storage.migrations (
  id integer NOT NULL,
  name character varying NOT NULL UNIQUE,
  hash character varying NOT NULL,
  executed_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT migrations_pkey PRIMARY KEY (id)
);
CREATE TABLE storage.objects (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  bucket_id text,
  name text,
  owner uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  last_accessed_at timestamp with time zone DEFAULT now(),
  metadata jsonb,
  path_tokens ARRAY DEFAULT string_to_array(name, '/'::text),
  version text,
  owner_id text,
  user_metadata jsonb,
  CONSTRAINT objects_pkey PRIMARY KEY (id),
  CONSTRAINT objects_bucketId_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id)
);
CREATE TABLE storage.s3_multipart_uploads (
  id text NOT NULL,
  in_progress_size bigint NOT NULL DEFAULT 0,
  upload_signature text NOT NULL,
  bucket_id text NOT NULL,
  key text NOT NULL,
  version text NOT NULL,
  owner_id text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  user_metadata jsonb,
  CONSTRAINT s3_multipart_uploads_pkey PRIMARY KEY (id),
  CONSTRAINT s3_multipart_uploads_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id)
);
CREATE TABLE storage.s3_multipart_uploads_parts (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  upload_id text NOT NULL,
  size bigint NOT NULL DEFAULT 0,
  part_number integer NOT NULL,
  bucket_id text NOT NULL,
  key text NOT NULL,
  etag text NOT NULL,
  owner_id text,
  version text NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT s3_multipart_uploads_parts_pkey PRIMARY KEY (id),
  CONSTRAINT s3_multipart_uploads_parts_upload_id_fkey FOREIGN KEY (upload_id) REFERENCES storage.s3_multipart_uploads(id),
  CONSTRAINT s3_multipart_uploads_parts_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id)
);
CREATE TABLE storage.vector_indexes (
  id text NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL,
  bucket_id text NOT NULL,
  data_type text NOT NULL,
  dimension integer NOT NULL,
  distance_metric text NOT NULL,
  metadata_configuration jsonb,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT vector_indexes_pkey PRIMARY KEY (id),
  CONSTRAINT vector_indexes_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets_vectors(id)
);